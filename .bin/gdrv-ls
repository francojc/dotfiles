#!/usr/bin/env bash
# Google Drive files listing wrapper (delegates to google-drive-files.sh)

SCRIPT_NAME="gdrv-ls"; SCRIPT_VERSION="1.0.0"
. "$(dirname "$0")/common.sh"

usage(){ cat <<EOF
Usage: gdrv-ls [args]

Delegate to google-drive-files.sh, preserving arguments.
EOF
}

main(){
  # shellcheck disable=SC2046
  set -- $(canonicalize_long_opts "$@")
  local show_help=0 show_version=0
  local OPTIND=1 opt
  while getopts ":hvq-:" opt; do
    case "$opt" in
      h) show_help=1 ;;
      v) VERBOSE=$((VERBOSE+1)) ;;
      q) QUIET=1 ;;
      -) case "$OPTARG" in version) show_version=1 ;; *) die "Unknown long option --$OPTARG";; esac ;;
      \?) die "Unknown option -$OPTARG" ;;
    esac
  done
  shift $((OPTIND-1)) || true
  [[ $show_help -eq 1 ]] && { usage; exit 0; }
  [[ $show_version -eq 1 ]] && { print_version; exit 0; }

  if [[ -x "$(dirname "$0")/google-drive-files.sh" ]]; then
    run "$(dirname "$0")/google-drive-files.sh" "$@"
  else
    die "google-drive-files.sh not found"
  fi
}

main "$@"
